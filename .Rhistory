library(plotly)
library(RColorBrewer)
library(tidyr)
library(dplyr)
library(waffle)
library(ggplot2)
overall_roberta = read.csv("../data/csv/pd_roberta_tags_for_goal_5.csv")
dist_graph = aggregate(count ~ subreddit, data = overall_roberta, FUN = sum)
fig <- plot_ly(dist_graph, x = ~subreddit, y = ~count, type = 'bar')
fig <- fig %>% layout(title = "Fig 1: Distribution of Sampled Comments Across Subreddits",
yaxis = list(title = 'Number of Comments'),
xaxis = list(title = 'Subreddit'),
barmode = 'group')
fig
first_graph_df <- aggregate(count ~ claim_long + subreddit, data = overall_roberta, FUN = sum)
df_wide <- spread(first_graph_df, key = subreddit, value = count)
df_wide[is.na(df_wide)] <- 0
df_wide <- df_wide %>%
mutate(climatechange_perc = climatechange / sum(climatechange, na.rm = TRUE) * 100,
climateskeptics_perc = climateskeptics / sum(climateskeptics, na.rm = TRUE) * 100,
conspiracy_perc = conspiracy / sum(conspiracy, na.rm = TRUE) * 100,)
fig <- plot_ly(df_wide, x = ~climatechange_perc, y = ~claim_long, type = 'bar', orientation = 'h', name = 'r/climatechange')
fig <- fig %>% add_trace(x = ~climateskeptics_perc, name = 'r/climateskeptics')
fig <- fig %>% add_trace(x = ~conspiracy_perc, name = 'r/conspiracy')
fig <- fig %>% layout(title = "Fig 2: Percentage Distribution of Claims Across Subreddits",
yaxis = list(title = 'Claim Description'),
xaxis = list(title = 'Percentage'),
barmode = 'group')
fig
library(gridExtra)
first_graph_df_waffle_climate_change <- first_graph_df[first_graph_df$subreddit == "climatechange" & first_graph_df$claim_long != "No claim", ]
waffle_climate_change <- ggplot(first_graph_df_waffle_climate_change, aes(fill = claim_long, values = count)) +
geom_waffle() +
coord_equal() +
theme_void() +
ggtitle("Figure 3.1: Distribution of Claims for r/climatechange") +
theme(legend.position = "bottom")
waffle_climate_change
first_graph_df_waffle_climate_skeptics <- first_graph_df[first_graph_df$subreddit == "climateskeptics" & first_graph_df$claim_long != "No claim", ]
waffle_climate_skeptics <- ggplot(first_graph_df_waffle_climate_skeptics, aes(fill = claim_long, values = count)) +
geom_waffle() +
coord_equal() +
theme_void() +
ggtitle("Figure 3.2: Distribution of Claims for r/climateskeptics")  +
theme(legend.position = "bottom")
waffle_climate_skeptics
first_graph_df_waffle_climate_skeptics <- first_graph_df[first_graph_df$subreddit == "climateskeptics" & first_graph_df$claim_long != "No claim", ]
waffle_climate_skeptics <- ggplot(first_graph_df_waffle_climate_skeptics, aes(fill = claim_long, values = count)) +
geom_waffle(n_rows = 10) +
coord_equal() +
theme_void() +
ggtitle("Figure 3.2: Distribution of Claims for r/climateskeptics")  +
theme(legend.position = "bottom")
waffle_climate_skeptics
first_graph_df_waffle_climate_skeptics <- first_graph_df[first_graph_df$subreddit == "climateskeptics" & first_graph_df$claim_long != "No claim", ]
waffle_climate_skeptics <- ggplot(first_graph_df_waffle_climate_skeptics, aes(fill = claim_long, values = count)) +
geom_waffle(n_rows = 20) +
coord_equal() +
theme_void() +
ggtitle("Figure 3.2: Distribution of Claims for r/climateskeptics")  +
theme(legend.position = "bottom")
waffle_climate_skeptics
first_graph_df_waffle_climate_skeptics <- first_graph_df[first_graph_df$subreddit == "climateskeptics" & first_graph_df$claim_long != "No claim", ]
waffle_climate_skeptics <- ggplot(first_graph_df_waffle_climate_skeptics, aes(fill = claim_long, values = count)) +
geom_waffle(n_rows = 30) +
coord_equal() +
theme_void() +
ggtitle("Figure 3.2: Distribution of Claims for r/climateskeptics")  +
theme(legend.position = "bottom")
waffle_climate_skeptics
install.packages("emojifont")
library(emojifont)
first_graph_df_waffle_climate_skeptics <- first_graph_df[first_graph_df$subreddit == "climateskeptics" & first_graph_df$claim_long != "No claim", ]
first_graph_df_waffle_climate_skeptics$label = fontawesome('fa-leaf')
waffle_climate_skeptics <- ggplot(first_graph_df_waffle_climate_skeptics, aes(fill = claim_long, values = count)) +
geom_waffle(n_rows = 30, aes(label=label)) +
coord_equal() +
theme_void() +
ggtitle("Figure 3.2: Distribution of Claims for r/climateskeptics")  +
theme(legend.position = "bottom")
waffle_climate_skeptics
library(emojifont)
first_graph_df_waffle_climate_skeptics <- first_graph_df[first_graph_df$subreddit == "climateskeptics" & first_graph_df$claim_long != "No claim", ]
first_graph_df_waffle_climate_skeptics$label = fontawesome('fa-leaf')
waffle_climate_skeptics <- ggplot(first_graph_df_waffle_climate_skeptics, aes(fill = claim_long, values = count)) +
geom_waffle(n_rows = 30, aes(label=label), family='fontawesome-webfont') +
coord_equal() +
theme_void() +
ggtitle("Figure 3.2: Distribution of Claims for r/climateskeptics")  +
theme(legend.position = "bottom")
waffle_climate_skeptics
library(emojifont)
first_graph_df_waffle_climate_skeptics <- first_graph_df[first_graph_df$subreddit == "climateskeptics" & first_graph_df$claim_long != "No claim", ]
first_graph_df_waffle_climate_skeptics$label = fontawesome('fa-leaf')
waffle_climate_skeptics <- ggplot(first_graph_df_waffle_climate_skeptics, aes(fill = claim_long, values = count)) +
geom_waffle(n_rows = 30) +
coord_equal() +
theme_void() +
ggtitle("Figure 3.2: Distribution of Claims for r/climateskeptics")  +
theme(legend.position = "bottom")
waffle_climate_skeptics
library(emojifont)
first_graph_df_waffle_climate_skeptics <- first_graph_df[first_graph_df$subreddit == "climateskeptics" & first_graph_df$claim_long != "No claim", ]
first_graph_df_waffle_climate_skeptics$label = fontawesome('fa-twitter')
waffle_climate_skeptics <- ggplot(first_graph_df_waffle_climate_skeptics, aes(fill = claim_long, values = count)) +
geom_waffle(n_rows = 30, aes(label=label), family='fontawesome-webfont') +
coord_equal() +
theme_void() +
ggtitle("Figure 3.2: Distribution of Claims for r/climateskeptics")  +
theme(legend.position = "bottom")
waffle_climate_skeptics
